@{
    ViewBag.Title = "frmNarcoticLicense";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="~/AdminLTE/plugins/jQuery/jquery-2.2.3.min.js"></script>
<link href="~/Content/CSS/InputText.css" rel="stylesheet" />
<div class="box-header with-border">
    @*Form Title*@
    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4"> <div id="MessageText"></div></div>
    <div class="col-xs-0 col-sm-0 col-md-8 col-lg-8">
        <div style="text-align:right;">
            <button id="btnSave" class="btn btn-primary btn-lg" type="button"><i class="glyphicon glyphicon-save"></i>Save</button>
            <button id="btnView" class="btn btn-primary btn-lg" type="button"><i class="glyphicon glyphicon-search"></i>Search</button>
            @* <button id="btnDelete" class="btn btn-primary btn-lg" type="button"><i class="glyphicon glyphicon-trash"></i>Delete</button>*@
            <button id="btnReset" class="btn btn-primary btn-lg" type="button"><i class="glyphicon glyphicon-refresh"></i>Reset</button>
        </div>
    </div>
</div>

<div class="box-body">
    <div class="form-group">
        <div class="row">
            <div class="col-sm-2">Company Code<span style="color: red">*</span> : </div>
            <div class="col-sm-2">
                <input type="text" id="CompanyCode" name="CompanyCode" class="form-control txtBox" readonly />
            </div>
            <div class="col-sm-1"><button id="btnFind" class="btn btn-primary btn-md" type="button"><i class="glyphicon glyphicon-search"></i>Search</button></div>
            <div class="col-sm-2">Company Name :</div>
            <div class="col-sm-5"><input type="text" id="CompanyName" name="CompanyName" class="form-control" readonly /></div>
        </div>
    </div>
    <div class="form-group">
        <div class="row">
            <div class="col-sm-2">License Type & No :</div>
            <div class="col-sm-3"><input type="text" id="LicenseNo" name="LicenseNo" class="form-control txtBox" /></div>
            <div class="col-sm-2">Narcotic License Type<span style="color: red">*</span> :</div>
            <div class="col-sm-2">
                <select id="LicenseType" class="txtBox" name="LicenseType">
                    <option value="">--Select Any--</option>
                    <option value="Import Permit">Import Permit</option>
                    <option value="Production And Processing">Production And Processing</option>
                    <option value="Export">Export</option>
                    <option value="Usage">Usage</option>
                </select>
            </div>
            <div class="col-sm-1">
            </div>
            <div class="col-sm-2">
                <input type="hidden" id="SlNo" name="SlNo" class="form-control txtBox" />
                <input type="hidden" id="ID" name="ID" class="txtBox" />
            </div>
        </div>
    </div>

    <div class="form-group">
        <div class="row">
            <div class="col-sm-2">Submission Type :</div>
            <div class="col-sm-3">
                <select id="SubmissionType" class="txtBox" disabled="disabled">
                    <option selected="selected" value="License">License</option>
                    <option value="Renewal">Renewal</option>
                </select>
            </div>
            <div class="col-sm-2">Revision No :</div>
            <div class="col-sm-2"><input type="text" id="RevisionNo" name="RevisionNo" placeholder="Auto" class="form-control" readonly /></div>
            <div class="col-sm-1"></div>
            <div class="col-sm-2">
                <button id="btnRevision" class="btn btn-primary btn-md" type="button"><i class="glyphicon glyphicon-plus"></i>Renew</button>
            </div>
        </div>
        <fieldset class="panel-border" id="divRenew">
            <legend class="panel-border">License/Renew Info :</legend>
            <div class="form-group">
                <div class="row">
                    <div class="col-sm-1"> </div>
                    <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2">Submission Date : </div>
                    <div class="col-xs-0 col-sm-0 col-md-3 col-lg-3">
                        <div class="input-group date">
                            <input type="text" class="form-control" id="SubmissionDate" name="SubmissionDate" placeholder="dd/mm/yyyy">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2">Factory Inspection Date: </div>
                    <div class="col-xs-0 col-sm-0 col-md-3 col-lg-3">
                        <div class="input-group date">
                            <input type="text" class="form-control" id="InspectionDate" name="InspectionDate" placeholder="dd/mm/yyyy">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-sm-1"> </div>
                    <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2">Approval Date : </div>
                    <div class="col-xs-0 col-sm-0 col-md-3 col-lg-3">
                        <div class="input-group date">
                            <input type="text" class="form-control" id="ApprovalDate" name="ApprovalDate" placeholder="dd/mm/yyyy">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2">Alarm Days : </div>
                    <div class="col-xs-0 col-sm-0 col-md-3 col-lg-3">
                        <input type="text" id="AlarmDays" name="AlarmDays" maxlength="5" placeholder="Alarm Days" class="txtBox form-control numeric " />
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-sm-1"> </div>
                    <div class="col-xs-12 col-sm-6 col-md-2 col-lg-2">Valid Up To : </div>
                    <div class="col-sm-3">
                        <div class="input-group date">
                            <input type="text" class="form-control txtBox" id="ValidUpto" name="ValidUpto" placeholder="dd/mm/yyyy">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span>
                        </div>
                    </div>
                    @*<div class="col-xs-12 col-sm-6 col-md-2 col-lg-2">Entry Date : </div>
                    <div class="col-xs-0 col-sm-0 col-md-3 col-lg-3">
                        <input type="text" class="form-control" id="RevisionDate" name="RevisionDate" readonly>
                    </div>*@
                </div>
            </div>
        </fieldset>
        <div class="row">
            <div class="col-sm-12">
                <fieldset class="panel-border">
                    <legend class="panel-border"> Generic Info :</legend>
                    <div class="row">
                        <div class="col-sm-12">
                            <div id="GenericDetailGrid" class=""></div>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <fieldset class="panel-border">
                    <legend class="panel-border">Upload Documents :</legend>
                    <div class="row">
                        <div class="col-sm-2">
                            Document Name<span style="color: red">*</span>:
                        </div>
                        <div class="col-sm-3">
                            <select id="RefNo" class="form-control txtBox" tabindex="" name="RefNo">
                                <option value="">--Select Any--</option>
                                <option value="Import Permit License">Import Permit License</option>
                                <option value="Production And Processing License">Production And Processing License</option>
                                <option value="Export License">Export License</option>
                                <option value="Usage License">Usage License</option>
                                <option value="Import Permit Letter">Import Permit Letter</option>
                                <option value="NOC Letter">NOC Letter</option>
                                <option value="Export Permit Letter">Export Permit Letter</option>
                            </select>
                        </div>
                        <div class="col-sm-4">
                            <input type="file" class="txtBox" id="UploadFile" name="UploadFile" />
                            <i class="glyphicon glyphicon-upload form-control-feedback"></i>
                        </div>
                        <div class="col-sm-3">
                        </div>
                    </div>
                    <div class="row">
                        <br />
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <label>List of Document File</label>
                            <div id="FileGrid" class=""></div>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
    </div>
</div>
<div class="box-footer">@*Form Footer*@</div>
<div class="row">
    <div id="DisplayPopupWindow" class="PopupWindowLayout" style="display: none;">
        <div id="DisplayPopupWindowGrid" class="PopUpGrid"></div>
    </div>
    <div id="GenericPopupWindow" class="PopupWindowLayout" style="display: none;">
        <div id="GenericPopupWindowGrid" class="PopUpGrid"></div>
    </div>

    <div id="CompanyWindow" class="PopupWindowLayout" style="display: none;">
        <div id="CompanyWindowGrid" class="PopUpGrid"></div>
    </div>
    <div id="DeleteConfirmWindow" style="display: none;">
        <p><h5>Are you sure to delete?</h5></p>
        <input type="button" style="height: 25px; width: 60px; margin-left: 10px; float: left;" id="btnConfirmationOK" value="OK" />
        <input type="button" style="height: 25px; width: 60px; margin-left: 30px; float: left;" id="btnConfirmationCancel" value="Cancel" />
    </div>
</div>
<div id="divLoading" style="margin: 0px; padding: 0px; position: fixed; right: 0px;
        top: 0px; width: 100%; height: 100%; background-color: #666666; z-index: 30001;
        opacity: .8; filter: alpha(opacity=70);display:none">
    <p style="position: absolute; top: 50%; left: 42%; color: White;">
        Please wait... <img src="../../Content/Images/ajax-loader1.gif">
    </p>
</div>
<script type="text/javascript">
    var dataItemInfo = {};
    var deleteId = "";

    $('#btnReset').click(function () {
        ResetData();
        $('#btnFind').removeAttr('disabled');
        $('#LicenseType').removeAttr('disabled');
        $("#FileGrid").data("kendoGrid").dataSource.data([]);
        $("#GenericDetailGrid").data("kendoGrid").dataSource.data([]);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(3);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(4);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(5);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(6);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(7);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(8);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(9);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(10);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(11);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(12);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(13);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(14);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(15);
        $("#GenericDetailGrid").data("kendoGrid").showColumn(32);
        //$("#GenericDetailGrid").data("kendoGrid").hideColumn(21);

        $("#GenericDetailGrid").data("kendoGrid").hideColumn(21);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(22);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(23);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(24);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(25);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(26);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(27);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(28);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(29);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(30);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(31);


        $("#GenericDetailGrid").data("kendoGrid").hideColumn(15);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(16);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(17);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(18);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(19);
        $("#GenericDetailGrid").data("kendoGrid").hideColumn(20);
    });
    $('#btnRevision').click(function () {
        $('#ID').val('');
        $('#SlNo').val('');
        $('#RevisionNo').val('');
        $("#SubmissionType ").val('Renewal');
        $("#divRenew").find('input, textarea, select').val('');
        $("#FileGrid").data("kendoGrid").dataSource.data([]);
        $("#GenericDetailGrid").data("kendoGrid").dataSource.data([]);
    });


    $(document).ready(function () {

        $(".datePicker").kendoDatePicker({
            format: "{0:dd/MM/yyyy}",
        });
        CheckUnSavedData();
        //  EventPermission();
        $('.input-group.date').datepicker({
            format: "d/mm/yyyy",//dd M yyyy
            // daysOfWeekDisabled: "5,6",
            autoclose: true,
            todayHighlight: true
            //,todayBtn: true,
        });

        $('#LicenseType').on('change', function () {
            alert(this.value);
            if (this.value == '') {
                $("#GenericDetailGrid").data("kendoGrid").showColumn(3);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(4);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(5);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(6);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(7);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(8);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(9);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(10);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(11);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(12);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(13);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(14);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(32);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(21);

                $("#GenericDetailGrid").data("kendoGrid").hideColumn(21);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(22);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(23);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(24);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(25);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(26);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(27);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(28);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(29);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(30);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(31);


                $("#GenericDetailGrid").data("kendoGrid").hideColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(16);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(17);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(18);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(19);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(20);
            }
            if (this.value == 'Import Permit') {
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(21);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(22);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(23);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(24);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(25);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(26);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(27);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(28);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(29);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(30);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(31);


                $("#GenericDetailGrid").data("kendoGrid").showColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(16);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(17);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(18);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(19);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(20);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(32);

            }
            if (this.value == 'Export') {
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(16);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(17);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(18);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(19);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(20);


                $("#GenericDetailGrid").data("kendoGrid").showColumn(21);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(22);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(23);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(24);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(25);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(26);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(27);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(28);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(29);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(30);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(31);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(32);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(5);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(5);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(5);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(5);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(5);
            }
            if (this.value == 'Production And Processing') {
                $("#GenericDetailGrid").data("kendoGrid").showColumn(3);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(4);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(5);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(6);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(7);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(8);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(9);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(10);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(11);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(12);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(13);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(14);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(32);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(21);

                $("#GenericDetailGrid").data("kendoGrid").hideColumn(21);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(22);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(23);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(24);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(25);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(26);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(27);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(28);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(29);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(30);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(31);


                $("#GenericDetailGrid").data("kendoGrid").hideColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(16);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(17);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(18);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(19);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(20);
            }

            if (this.value == 'Usage') {
                $("#GenericDetailGrid").data("kendoGrid").showColumn(3);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(4);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(5);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(6);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(7);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(8);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(9);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(10);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(11);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(12);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(13);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(14);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(32);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(21);

                $("#GenericDetailGrid").data("kendoGrid").hideColumn(21);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(22);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(23);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(24);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(25);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(26);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(27);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(28);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(29);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(30);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(31);


                $("#GenericDetailGrid").data("kendoGrid").hideColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(16);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(17);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(18);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(19);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(20);
            }
            //if (thi.value = 'Export') {
            //    alert(this.value);
            //}
            //else {
            //alert(this.value);
            //}

        });

        $('#btnView').click(function () {
            DisplayPopupWindow.open();
            $.ajax({
                url: '@Url.Action("GetAllInfo", "NarcoticLicense")',
                method: 'get',
                data: 'json',
                success: function (data) {
                    if (data != "") {
                        $('#DisplayPopupWindowGrid').data('kendoGrid').dataSource.data(data);
                    }
                    else {
                        DisplayPopupWindow.close();
                        AcknowledgeMsg();
                    }
                }
            });

        });

        //Initializing Main page details Kendo Grid Colums
        var PopupGrid = $('#DisplayPopupWindowGrid').kendoGrid({
            dataSource: new kendo.data.DataSource({
                batch: true,
                schema: {
                    model: {
                        id: "ID",
                        fields: {
                            ID: { type: "string" },
                        }
                    }
                },
                pageSize: 20,
            }),
            pageable: {
                //refresh: true,
                pageSizes: true, buttonCount: 5
            },
            scrollable: true,
            sortable: true,
            filterable: true,
            editable: false,
            selectable: "row",
            //selectable: "multiple",
            toolbar: ["excel", { template: "<input type='text' id='txtPopupInput'  style='float:right' placeholder='Search...' class='k-textbox'>" }, ],
            excel: {
                fileName: "Export.xlsx",
                allPages: true,
                filterable: true
            },
            navigatable: true,
            height: "100%",
            // groupable: true,
            groupable: { messages: { empty: "Custom message text" } },
            columnMenu: true,
            reorderable: true,
            resizable: true,
            columns: [
                 { field: "ID", hidden: true },
                 { field: "SlNo ", hidden: true, title: "SlNo", width: 70 },
                 { field: "CompanyCode", title: "Code", width: 70 },
                 { field: "CompanyName", title: "CompanyName", width: 140 },
                 { field: "RevisionNo", title: "RevisionNo", width: 100 },
                 { field: "SubmissionType", title: "SubmissionType", width: 120 },
                 { field: "LicenseNo", title: "LicenseType & No", width: 120 },
                 { field: "LicenseType", title: "LicenseType", width: 100 },
                 { field: "SubmissionDate", title: "SubmissionDate", width: 120 },
                 { field: "InspectionDate", title: "InspectionDate", width: 120 },
                 { field: "ValidUpto", title: "ValidUpto", width: 120 },
                 { field: "ApprovalDate", title: "ApprovalDate", width: 120 },
                // { field: "GenericName", title: "GenericName", width: 100, hidden: true },
                //{ field: "BrandName", title: "BrandName", width: 100, hidden: true },
                //{ field: "AnnualQuota", title: "AnnualQuota", width: 100, hidden: true },
                //{ field: "SubQty", title: "SubQty", width: 100, hidden: true },
                //{ field: "SubDGDA", title: "SubDGDA", width: 100, hidden: true },
                //{ field: "ApproveDGDA", title: "ApproveDGDA", width: 100, hidden: true },
                //{ field: "SubNercotic", title: "SubNercotic", width: 100, hidden: true },
                //{ field: "ImportQtyPerYr", title: "ImportQtyPerYr", width: 100, hidden: true },
                //{ field: "ImportQtyCurYr", title: "ImportQtyCurYr", width: 100, hidden: true },
                //{ field: "ImportPurpose", title: "ImportPurpose", width: 100, hidden: true },
                //{ field: "PermitApprovalDate", title: "PermitApprovalDate", width: 100, hidden: true },
                //{ field: "ImportDate", title: "ImportDate", width: 100, hidden: true },
                //{ field: "ImportQty", title: "ImportQty", width: 100, hidden: true },
                //{ field: "RecSentNarc", title: "RecSentNarc", width: 100, hidden: true },
                //{ field: "InsRptRcvNarc", title: "InsRptRcvNarc", width: 100, hidden: true },
                //{ field: "SubInsRptNhq", title: "SubInsRptNhq", width: 100, hidden: true },
                //{ field: "SubInsRptNarc", title: "SubInsRptNarc", width: 100, hidden: true },
                //{ field: "FinalImpPermit", title: "FinalImpPermit", width: 100, hidden: true },
                //{ field: "RMImpQty", title: "RMImpQty", width: 100, hidden: true },
                //{ field: "SendToPPIC", title: "SendToPPIC", width: 100, hidden: true },
                //{ field: "PPICLocalApp", title: "PPICLocalApp", width: 100, hidden: true },
                //{ field: "InsSampleCall", title: "InsSampleCall", width: 100, hidden: true },
                //{ field: "SampleRec", title: "SampleRec", width: 100, hidden: true },
                //{ field: "RPTDispatch", title: "RPTDispatch", width: 100, hidden: true },
                //{ field: "PPICSent", title: "PPICSent", width: 100, hidden: true },
                //{ field: "PPICApplyNarc", title: "PPICApplyNarc", width: 100, hidden: true },
                //{ field: "RptForwrdRcv", title: "RptForwrdRcv", width: 100, hidden: true },
                //{ field: "DivToDnc", title: "DivToDnc", width: 100, hidden: true },
                //{ field: "FinalPermit", title: "FinalPermit", width: 100, hidden: true },
                //{ field: "DeliverToIMD", title: "DeliverToIMD", width: 100, hidden: true },
//                { field: "DivToDnc", title: "DivToDnc", width: 100 },


            ]

        }).data('kendoGrid');

        $('#DisplayPopupWindowGrid').dblclick(function () {
            var grid = $(this).data('kendoGrid');
            var selectRow = grid.dataItem(grid.select());
            DisplayPopupWindow.close();
            $('#btnFind').attr('disabled', 'disabled');
            $('#LicenseType').attr('disabled', 'disabled');
            var type = selectRow.LicenseType;
            if (type == 'Import Permit') {
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(21);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(22);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(23);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(24);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(25);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(26);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(27);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(28);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(29);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(30);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(31);


                $("#GenericDetailGrid").data("kendoGrid").showColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(16);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(17);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(18);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(19);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(20);
            }
            if (type == 'Export') {
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(16);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(17);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(18);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(19);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(20);


                $("#GenericDetailGrid").data("kendoGrid").showColumn(21);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(22);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(23);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(24);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(25);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(26);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(27);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(28);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(29);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(30);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(31);
            }
            if (type == 'Production And Processing') {
                $("#GenericDetailGrid").data("kendoGrid").showColumn(3);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(4);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(5);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(6);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(7);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(8);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(9);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(10);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(11);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(12);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(13);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(14);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(15);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(1);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(21);

                $("#GenericDetailGrid").data("kendoGrid").hideColumn(21);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(22);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(23);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(24);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(25);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(26);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(27);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(28);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(29);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(30);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(31);


                $("#GenericDetailGrid").data("kendoGrid").hideColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(16);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(17);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(18);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(19);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(20);
            }
            if (type == 'Usage') {
                $("#GenericDetailGrid").data("kendoGrid").showColumn(3);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(4);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(5);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(6);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(7);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(8);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(9);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(10);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(11);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(12);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(13);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(14);
                $("#GenericDetailGrid").data("kendoGrid").showColumn(15);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(1);
                //$("#GenericDetailGrid").data("kendoGrid").hideColumn(21);

                $("#GenericDetailGrid").data("kendoGrid").hideColumn(21);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(22);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(23);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(24);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(25);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(26);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(27);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(28);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(29);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(30);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(31);


                $("#GenericDetailGrid").data("kendoGrid").hideColumn(15);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(16);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(17);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(18);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(19);
                $("#GenericDetailGrid").data("kendoGrid").hideColumn(20);
            }
            SetMasterData(selectRow);
            loadGenericDetail(selectRow.ID);

            $.ajax({
                url: '@Url.Action("GetFileByRefIdAndDetailData", "NarcoticLicense")',
                type: 'GET',
                data: { refLevel1: selectRow.ID },
                success: function (data) {
//                    var BrandName = val(data[0].BrandName);
//                    alert(BrandName);

                    //$("#GenericDetailGrid").data("kendoGrid").dataSource.data(data.dataDetail);
                    //$('#GenericDetailGrid').data('kendoGrid').dataSource.data(data);
                    $("#FileGrid").data("kendoGrid").dataSource.data(data.dataFile);
                }
            });




        });


        function loadGenericDetail(ID) {
            $.ajax({
                url: '/NarcoticLicense/GetDetailGeneric',
                method: 'post',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify({ ID: ID }),
                dataType: 'json',
                success: function (data) {
                    if (data != "") {
                        $('#GenericDetailGrid').data('kendoGrid').dataSource.data(data);
                    }
                    else {
                        DisplayPopupWindow.close();
                        AcknowledgeMsg();
                    }
                }
            });
        }




        //Produc Name wise Filter table row
        $("#txtPopupInput").keyup(function () {
            var val = $(this).val();
            $("#DisplayPopupWindowGrid").data("kendoGrid").dataSource.filter({
                logic: "or",
                filters: [
                     { field: "SlNo", operator: "contains", value: val },
                     { field: "CompanyCode", operator: "contains", value: val },
                     { field: "SubmissionType", operator: "contains", value: val },
                     { field: "RevisionNo", operator: "contains", value: val },
                     { field: "LicenseNo", operator: "contains", value: val },
                     { field: "LicenseType", operator: "contains", value: val },
                     { field: "ValidUpto", operator: "contains", value: val },
                     { field: "CompanyName", operator: "contains", value: val },
                     { field: "AlarmDays", operator: "contains", value: val }
                ]
            });
        });

        //Display window
        var DisplayPopupWindow = $("#DisplayPopupWindow").kendoWindow({
            actions: ["Minimize", "Maximize", "Close"],
            width: "90%",
            height: "80%",
            draggable: true,
            modal: true,
            title: "List of Values."
        }).data("kendoWindow").center();


        var GenericPopupWindow = $('#GenericPopupWindow').kendoWindow({
            actions: ["Minimize", "Maximize", "Close"],
            visible: false,
            width: "90%",
            height: "80%",
            title: "List Of Generic",
            position: { top: 100, left: 300 },
            modal: true,
            draggable: true
        }).data('kendoWindow');

        //$(document).on('keyup', '.GenericName', function (e) {
        //    if (e.which == 120) {
        //        SelectedItemOfListOfValue('GenericPopupWindowGrid');
        //        GenericPopupWindow.open(); //Open Popup
        //    }

        //});
        //To select the first row as default & to clear the filter while loading the grid
        function SelectedItemOfListOfValue(gridName) {
            var grid = $('#' + gridName).data("kendoGrid");
            //Reload Grid
            grid.dataSource.read();
            //Clear Filter
            $('#' + gridName).data("kendoGrid").dataSource.filter([]);
            //Select First Row
            $('#' + gridName).data().kendoGrid.bind('dataBound', function (e) {
                this.element.find('tbody tr:first').addClass('k-state-selected');
            });
        }
        //To Bring Data from List of Value Grid to Main Page
        function getGenericValueOfGridEvent() {
            var windowGrid = $("#GenericPopupWindowGrid").data("kendoGrid");
            var windowGridRow = windowGrid.select();
            var windowGridItem = windowGrid.dataItem(windowGridRow);

            var pageGrid = $("#GenericDetailGrid").data("kendoGrid");
            var pageGridItem = pageGrid.dataItem(pageGrid.select());

            pageGridItem.set("GenericCode", windowGridItem.GenericCode);
            pageGridItem.set("GenericName", windowGridItem.GenericName);
            pageGridItem.set("BrandName", windowGridItem.BrandName);

            $("#GenericDetailGrid").data().kendoGrid.bind('dataBound', function () {
                this.element.find('tbody tr:first').addClass('k-state-selected');
            });

        }


        //Initializing Main page details Kendo Grid Colums
        var GenericPopupGrid = $('#GenericPopupWindowGrid').kendoGrid({
            dataSource: new kendo.data.DataSource({
                batch: true,
                schema: {
                    model: {
                        id: "GenericCode",
                        fields: {
                            GenericCode: { type: "string" },
                        }
                    }
                },
                transport: {
                    read: {
                        url: '@Url.Action("GetGenericBrand", "NarcoticLicense")',
                        type: "GET",
                        dataType: "JSON"
                    }
                },
                pageSize: 10,
            }),
            pageable: {
                //refresh: true,
                pageSizes: true, buttonCount: 5
            },
            scrollable: true,
            sortable: true,
            filterable: true,
            editable: false,
            selectable: "row",
            //selectable: "multiple",
            toolbar: [{ template: "<input type='text' id='txtGenericPopupInput'  style='float:right' placeholder='Search...' class='k-textbox'>" }, ],
            navigatable: true,
            height: 430,
            // groupable: true,
            groupable: { messages: { empty: "Custom message text" } },
            columnMenu: true,
            reorderable: true,
            resizable: true,
            columns: [
                 //{ field: "GenericCode", title: "GenericCode", width: 80 },
                 { field: "GenericName", title: "GenericName", width: 100 },
                 { field: "BrandName", title: "BrandName", width: 100 },
                 { field: "Status", title: "Status", width: 80 }
            ]
        }).data('kendoGrid');

        $('#GenericPopupWindowGrid').dblclick(function () {
            var grid = $(this).data('kendoGrid');
            var selectRow = grid.dataItem(grid.select());
            GenericPopupWindow.close();
//            SetMasterData(selectRow);
        });

        $("#GenericPopupWindowGrid").dblclick(function () {
            getGenericValueOfGridEvent();
            GenericPopupWindow.close();
        });
        $("#txtGenericPopupInput").keyup(function () {
            var val = $(this).val();
            $("#GenericPopupWindowGrid").data("kendoGrid").dataSource.filter({
                logic: "or",
                filters: [
                     { field: "GenericCode", operator: "contains", value: val },
                     { field: "GenericName", operator: "contains", value: val },
                     { field: "Status", operator: "contains", value: val },
                ]
            });
        });

        // Company window for find button
        var CompanyWindow = $("#CompanyWindow").kendoWindow({
            actions: ["Minimize", "Maximize", "Close"],
            width: "90%",
            height: "80%",
            draggable: true,
            modal: true,
            title: "List of Company."
        }).data("kendoWindow").center();


        $('#btnFind').click(function () {
            CompanyWindow.open();
            $.ajax({
                url: '@Url.Action("GetAllCompany", "General")',
                method: 'get',
                data: 'json',
                success: function (data) {
                    if (data != "") {
                        $('#CompanyWindowGrid').data('kendoGrid').dataSource.data(data);
                    }
                    else {
                        CompanyWindow.close();
                        AcknowledgeMsg();
                    }

                }
            });

        });

        //Initializing Main page details Kendo Grid Colums
        var companyGrid = $('#CompanyWindowGrid').kendoGrid({
            dataSource: new kendo.data.DataSource({
                batch: true,
                schema: {
                    model: {
                        id: "CompanyCode",
                        fields: {
                            CompanyCode: { type: "string" },
                        }
                    }
                },
                pageSize: 10,
            }),
            pageable: {
                //refresh: true,
                pageSizes: true, buttonCount: 10
            },
            scrollable: true,
            sortable: true,
            filterable: true,
            editable: false,
            selectable: "row",
            //selectable: "multiple",
            toolbar: [{ template: "<input type='text' id='txtCompanyKeyword'  style='float:right' placeholder='Search...' class='k-textbox'>" }, ],
            navigatable: true,
            height: 430,
            // groupable: true,
            groupable: { messages: { empty: "Custom message text" } },
            columnMenu: true,
            reorderable: true,
            resizable: true,
            columns: [
                 { field: "CompanyCode", title: "CompanyCode", width: 80 },
                 { field: "CompanyName", title: "CompanyName", width: 100 },
                 { field: "Address", title: "CompanyAddress", width: 160 },
                 { field: "LicenseNo", title: "LicenseType & No", width: 120 }
            ]

        }).data('kendoGrid');

        $('#CompanyWindowGrid').dblclick(function () {
            var grid = $(this).data('kendoGrid');
            var selectRow = grid.dataItem(grid.select());

            CompanyWindow.close();
            SetMasterData(selectRow);
            changeAny = 1;

        });

        //Company Name wise Filter table row
        $("#txtCompanyKeyword").keyup(function () {
            var val = $(this).val();
            $("#CompanyWindowGrid").data("kendoGrid").dataSource.filter({
                logic: "or",
                filters: [
                     { field: "CompanyCode", operator: "contains", value: val },
                     { field: "CompanyName", operator: "contains", value: val },
                     { field: "Address", operator: "contains", value: val },
                ]
            });
        });

        //--------------------------------------Start of defining Datagrid--------------------------------------------------------
        var itemGridDataSource = new kendo.data.DataSource({
            schema: {
                model: {
                    id: "ID",
                    fields: {
                        ID: { editable: true },
                        //GenericCode: { editable: true },
                        GenericCode: { editable: true, defaultValue: 'Double click' },
                        AnnualQuota: { editable: true },//type: "number", validation: { min: 0, max: 999999999999 }, defaultValue: ''
                        ImportQtyPerYr: { editable: true },
                        ImportQtyCurYr: { editable: true },
                        ImportPurpose: { editable: true },
                        PermitApprovalDate: { editable: true },
                        ImportQty: { editable: true },
                        ImportDate: { editable: true },
                        SubDGDA: { editable: true },
                        ApproveDGDA: { editable: true },
                        SubNercotic: { editable: true }
                    }
                }
            },
            pageSize: 50
        });
        var genericItemGrid = $("#GenericDetailGrid").kendoGrid({
            dataSource: itemGridDataSource,
            pageable: true,
            editable: true,
            selectable: "row",
            navigatable: true,
            filterable: true,
            sortable: true,
            scrollable: true,
            resizable: true,
            filterable: {
                extra: false,
                operators: {
                    string: {
                        startswith: "Starts with",
                        contains: "Contains"
                    }
                }
            },
            edit: function (e) {
                $("[name='GenericCode']", e.container).on("keyup keypress keydown dblclick", function () {
                    SelectedItemOfListOfValue('GenericPopupWindowGrid');
                    GenericPopupWindow.open(); //Open Popup
                });
            },
            //height: 350,
            toolbar: [{
                text: "Add Generic Info",
                className: "btnGenericDetailGrid",
                imageClass: "k-icon k-add"
            }, "excel"],
            excel: {
                fileName: "Export.xlsx",
                allPages: true,
                filterable: true
            },
            columns: [
                  { field: "ID", hidden: true },
                  { field: "NLID", hidden: true },
                  { field: "DetailID", hidden: false },
                  //{ field: "GenericCode", hidden: true },
                  //{ field: "DetailID", locked: false, title: "Generic Name", width: "120px", filterable: false, sortable: false, attributes: { "class": "txtBox GenericName" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "GenericCode", locked: false, title: "Generic Name", width: "120px", filterable: false, sortable: false, attributes: { "class": "txtBox GenericName" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "BrandName", title: "Brand Name", width: "150px", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "AnnualQuota", title: "Annual Quota", width: "150px", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  //{ field: "SubQty", title: "SubQty", width: "100px", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "SubDGDA", title: "Submission DGDA", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "ApproveDGDA", title: "Approval From DGDA", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "SubNercotic", title: "SubmissionNarcotic", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "ImportQtyPerYr", title: "Import Qty Per year", width: "200px", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "ImportQtyCurYr", title: "Import Qty Current year", width: "200px", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "ImportPurpose", title: "Import Purpose", width: "160px", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "PermitApprovalDate", title: "Approval Permit Date", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "ImportDate", title: "Import Date", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "ImportQty", title: "ImportQty", width: "200px", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },



                  { field: "RecSentNarc", title: "Recommendation Sent Narcotics", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "InsRptRcvNarc", title: "Inspection Report Receive Narcotics", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "SubInsRptNarc", title: "Submission Narcotics Region Office ", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "SubInsRptNhq", title: "Submission Narcotics Head Office ", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "FinalImpPermit", title: "Final Import Permit", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "RMImpQty", title: "RM Import Qty", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                                    //{ field: "RecSentNarc", title: "RecSentNarc", width: "120px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "SendToPPIC", title: "SendToPPIC", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "PPICLocalApp", title: "PPIC Local Application", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "InsSampleCall", title: "Inspaction Sample Callection", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "SampleRec", title: "Sample Received", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "RPTDispatch", title: "RPT Dispatch", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                                    //{ field: "RecSentNarc", title: "RecSentNarc", width: "120px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "PPICSent", title: "Report Sent PPIC", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "PPICApplyNarc", title: "PPIC Apply Narcotics", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "RptForwrdRcv", title: "RptForwrding Received Divisional Office", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "DivToDnc", title: "Divisional office DNC", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "FinalPermit", title: "Final Permit", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "DeliverToIMD", title: "DeliverTo IMD", width: "200px", editor: dateTimeEditor, format: "{0:dd/MM/yyyy}", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                  { field: "DtlRemarks", title: "Remarks", width: "200px", attributes: { "class": "txtBox" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },

                  { command: [{ name: "DeltedRow", text: "Delete", imageClass: "glyphicon glyphicon-trash", click: handleDeleteItem }], title: "Action", width: 100, attributes: { style: "text-align:center" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px; text-align:center" } }
            ]
        }).data('kendoGrid');

        $(".btnGenericDetailGrid").click(function () {
            var grid = $("#GenericDetailGrid").data("kendoGrid");
            $("#GenericDetailGrid").data().kendoGrid.bind('dataBound', function () {
                this.element.find('tbody tr:first').addClass('k-state-selected');
            });
            grid.addRow();
        });

        $("#GenericDetailGrid").keyup(function (e) {
            if (e.keyCode == 13) {
                var grid = $("#GenericDetailGrid").data("kendoGrid");
                $("#GenericDetailGrid").data().kendoGrid.bind('dataBound', function () {
                    this.element.find('tbody tr:first').addClass('k-state-selected');
                });
                grid.addRow();
            }
        });
        // Display Date into kendo Grid Row
        function dateTimeEditor(container, options) {
            $('<input data-text-field="' + options.field + '" data-value-field="' + options.field + '" data-bind="value:' + options.field + '" data-format="' + options.format + '"/>')
                    .appendTo(container)
                    .kendoDatePicker({
                        //value: new Date(),
                        change: function () {
                            changeAny = 1;
                        }
                    });
        }

        //Handling Delete event for GenericDetailGrid row
        function handleDeleteItem() {
            deleteStatus = 2;//For grid data
            dataItemInfo = {};
            var grid = $("#GenericDetailGrid").data("kendoGrid");
            dataItemInfo = grid.dataItem(grid.select()); //Selected Row
            //deleteId = dataItemInfo.BrandName;
            //alert(dataItemInfo.ID);
            OpenConfirmationDialog();
        };
        //Handling Yes button click for grid row deletion
        $('#btnConfirmationOK').click(function () {
            if (deleteStatus == 2) {
                if (dataItemInfo != null) {
                    if (dataItemInfo.DetailID != "") {
                        $.ajax({
                            url: '@Url.Action("DeleteDataItem", "NarcoticLicense")',
                            type: 'POST',
                            data: JSON.stringify({ "id": dataItemInfo.DetailID }),
                            contentType: 'application/json;',
                            dataType: 'json',
                            success: function (respnse) {
                                if (respnse.Mode == "D") {
                                    toastr.success(OperationMsg("DD"));
                                    $("#GenericDetailGrid").data("kendoGrid").dataSource.remove(dataItemInfo);
                                } else {
                                    toastr.error(OperationMsg("DDF"));
                                }
                            }
                        });
                    } else {
                        $("#GenericDetailGrid").data("kendoGrid").dataSource.remove(dataItemInfo);
                        toastr.success(OperationMsg("GRR"));
                    }
                }
                else {
                    toastr.error(OperationMsg("DGR"));
                }
                CloseConfirmationDialog();
            }
        });

        //Handling No button click for grid row deletion
        $('#btnConfirmationCancel').click(function () {
            dataItemInfo = {};
            CloseConfirmationDialog();
        });

        function CloseConfirmationDialog() {
            ConfirmWindow.close();
        }
        var ConfirmWindow;
        function OpenConfirmationDialog() {
            ConfirmWindow = $('#DeleteConfirmWindow').kendoWindow({
                width: "300px",
                padding: "0px 0px 0px 100px",
                title: "Confirmation!",
                visible: false,
                resizable: false,
                draggable: true,
                position: { top: 200, left: 400 }
            }).data('kendoWindow');
            ConfirmWindow.open();
        }
        //To Define Data  for Kendo Grid
        var fileDataSource = new kendo.data.DataSource({
            batch: true,
            schema: {
                model: {
                    id: "FileID",
                    fields: {
                        FileID: { editable: false },
                        FileCode: { editable: false },
                        Extention: { editable: false },
                        FileName: { editable: false },
                        RefNo: { editable: false },
                        FileSize: { editable: false },
                        SetOn: { editable: false },
                        SetByName: { editable: false }
                    }
                }
            },
            pageSize: 10
        });

        //Initializing Main page details Kendo Grid Colums
        var grid = $('#FileGrid').kendoGrid({
            dataSource: fileDataSource,
            pageable: {
                pageSizes: true, buttonCount: 5
            },
            scrollable: true,
            sortable: true,
            filterable: true,
            editable: true,
            selectable: "row",
            toolbar: [{ template: "<input type='text' id='txtInput'  style='float:right' placeholder='Search by Keyword...' class='k-textbox'>" }, ],
            navigatable: true,
            groupable: true,
            columnMenu: true,
            reorderable: true,
            resizable: true,
            columns: [
            { field: "FileID", hidden: true },
            { field: "FileCode", hidden: true },
            { field: "Extention", hidden: true },
            { field: "RefNo", title: "Document Name", width: 150, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
            { field: "FileName", title: "File Name", width: 350, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
            { field: "FileSize", filterable: false, title: "Size(MB)", width: 100, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
            { command: [{ name: "Download", text: "Download", imageClass: "glyphicon glyphicon-download", click: handleDownload }], title: "Download Action", width: "120px", attributes: { "class": "btnDownload" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
            { command: [{ name: "Delete", text: "Delete", imageClass: "glyphicon glyphicon-trash", click: handleFileDelete }], title: "Delete Action", width: "120px", attributes: { "class": "btnDelete" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } }
            ]

        }).data('kendoGrid');

        $("#txtInput").keyup(function () {
            var val = $(this).val();
            $("#FileGrid").data("kendoGrid").dataSource.filter({
                logic: "or",
                filters: [
                     { field: "RefNo", operator: "contains", value: val },
                     { field: "FileName", operator: "contains", value: val },
                     { field: "FileSize", operator: "contains", value: val }
                ]
            });
        });

        function handleFileDelete(event) {
            dataItemInfo = grid.dataItem($(event.currentTarget).closest("tr"));

            if (confirm('Do you really want to delete this file?')) {
                //event.preventDefault();
                //event.stopPropagation();
                $.ajax({
                    url: '@Url.Action("DeleteFile", "General")',
                    type: 'POST',
                    data: JSON.stringify({ "fileId": dataItemInfo.FileID, "fileCode": dataItemInfo.FileCode, "extention": dataItemInfo.Extention }),
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    cache: false,
                    success: function (response) {
                        if (response.Status == "Yes") {
                            toastr.success(OperationMsg("FD"));
                            $("#FileGrid").data("kendoGrid").dataSource.remove(dataItemInfo);
                        }
                        else {
                            toastr.error(OperationMsg("FND"));
                        }
                    }
                });
            }
        };
        // Download Button in Grid
        function handleDownload(event) {
            dataItemInfo = grid.dataItem($(event.currentTarget).closest("tr"));
            window.location.href = '@Url.Action("Download", "General")' + '?path=' + dataItemInfo.FileCode + dataItemInfo.Extention + '&fileName=' + dataItemInfo.FileName + '&fileId=' + dataItemInfo.FileID;
        };

        $('#btnSave').click(function () {
            if (changeAny == 1) {
                var checkInput = InputValidation('CompanyCode') + InputValidation('LicenseType');
                if (checkInput == 0) {
                    model.NLDetail = [];
                    model.ID = $('#ID').val();
                    model.SlNo = $('#SlNo').val();
                    model.CompanyCode = $('#CompanyCode').val();
                    model.LicenseNo = $('#LicenseNo').val();
                    model.LicenseType = $('#LicenseType').val();
                    model.RevisionNo = $('#RevisionNo').val();
                    model.SubmissionType = $('#SubmissionType').val();
                    model.SubmissionDate = $('#SubmissionDate').val();
                    model.InspectionDate = $('#InspectionDate').val();
                    model.ApprovalDate = $('#ApprovalDate').val();
                    model.ValidUpto = $('#ValidUpto').val();
                    //model.RevisionDate = $('#RevisionDate').val();
                    model.AlarmDays = $('#AlarmDays').val();

                    var dataSource = $("#GenericDetailGrid").data("kendoGrid").dataSource;
                    var data = dataSource.data(); // Get Detail Grid Data
                    

                    if (data.length > 0) {
                        for (var i = 0; i < data.length; i++) {

                            //itemData = {};

                            //if (data[i].dirty) {
                                if (data[i].CompanyName == "") {
                                    checkGridData = 0;
                                    break;
                                }
                                itemData.ID = data[i].ID;
                                itemData.GenericCode = data[i].GenericCode;
                                itemData.AnnualQuota = data[i].AnnualQuota;
                                itemData.ImportQtyPerYr = data[i].ImportQtyPerYr;
                                itemData.ImportQtyCurYr = data[i].ImportQtyCurYr;
                                itemData.ImportPurpose = data[i].ImportPurpose;
                                itemData.PermitApprovalDate = data[i].PermitApprovalDate;
                                itemData.ImportQty = data[i].ImportQty;
                                itemData.ImportDate = data[i].ImportDate;
                                itemData.SubDGDA = data[i].SubDGDA;
                                itemData.ApproveDGDA = data[i].ApproveDGDA;
                                itemData.SubNercotic = data[i].SubNercotic;
                                itemData.RecSentNarc = data[i].RecSentNarc;
                                itemData.InsRptRcvNarc = data[i].InsRptRcvNarc;
                                itemData.SubInsRptNhq = data[i].SubInsRptNhq;
                                itemData.SubInsRptNarc = data[i].SubInsRptNarc;
                                itemData.FinalImpPermit = data[i].FinalImpPermit;
                                itemData.RMImpQty = data[i].RMImpQty;
                                itemData.SendToPPIC = data[i].SendToPPIC;
                                itemData.PPICLocalApp = data[i].PPICLocalApp;
                                itemData.InsSampleCall = data[i].InsSampleCall;
                                itemData.SampleRec = data[i].SampleRec;
                                itemData.RPTDispatch = data[i].RPTDispatch;
                                itemData.PPICSent = data[i].PPICSent;
                                itemData.PPICApplyNarc = data[i].PPICApplyNarc;
                                itemData.RptForwrdRcv = data[i].RptForwrdRcv;
                                itemData.DivToDnc = data[i].DivToDnc;
                                itemData.DetailID = data[i].DetailID;
                                //alert(data[i].DetailID);
                                itemData.FinalPermit = data[i].FinalPermit;
                                itemData.DeliverToIMD = data[i].DeliverToIMD;
                                itemData.BrandName = data[i].BrandName;
                                itemData.DtlRemarks = data[i].DtlRemarks;
                                model.NLDetail.push(itemData);
                                itemData = {
                                    "ID": "", "DetailID": "", "GenericCode": "", "AnnualQuota": "", "ImportQtyPerYr": "", "ImportQtyCurYr": "", "ImportPurpose": "", "PermitApprovalDate": "", "ImportQty": "", "ImportDate": "", "SubDGDA": "", "ApproveDGDA": "", "SubNercotic": "",
                                    "BrandName": "", "RecSentNarc": "", "InsRptRcvNarc": "", "SubInsRptNhq": "", "SubInsRptNarc": "", "FinalImpPermit": "", "RMImpQty": "", "SendToPPIC": "",
                                    "PPICLocalApp": "", "InsSampleCall": "", "SampleRec": "", "RPTDispatch": "", "PPICSent": "", "PPICApplyNarc": "", "RptForwrdRcv": "", "DivToDnc": "", "FinalPermit": "", "DeliverToIMD": "", "DtlRemarks": ""
                                };
                            //}
                        }
                    }
                    $.ajax({
                        url: '@Url.Action("frmNarcoticLicense", "NarcoticLicense")',
                        data: JSON.stringify(model),
                        type: 'POST',
                        contentType: 'application/json;',
                        dataType: 'json',
                        success: function (data) {
                            if (data.Status == "Yes") {
                                $("#ID").val(data.ID);
                                $("#SlNo").val(data.SlNo);
                                $("#RevisionNo").val(data.RevisionNo);
                                OperationMsg(data.Mode);
                                changeAny = 0;
                            }
                            else {
                                ErrorFrmServerMsg(data.Status);
                            }

                        }
                    }); //End of ajax call
                }
                else {
                    ValidationMsg();
                }
            }
            else {
                toastr.warning(OperationMsg("NC"));
            }

        });
        var model = {
            "ID": "", "SlNo": "", "CompanyCode": "", "LicenseNo": "", "RevisionNo": "", "LicenseType": "", "SubmissionType": "", "SubmissionDate": "",
            "InspectionDate": "", "ApprovalDate": "", "ValidUpto": "", "RevisionDate": "", "AlarmDays": "", "NLDetail": []
        };
        itemData = {
            "ID": "", "DetailID": "", "GenericCode": "", "AnnualQuota": "", "ImportQtyPerYr": "", "ImportQtyCurYr": "", "ImportPurpose": "", "PermitApprovalDate": "", "ImportQty": "", "ImportDate": "", "SubDGDA": "", "ApproveDGDA": "", "SubNercotic": "",
            "BrandName": "", "RecSentNarc": "", "InsRptRcvNarc": "", "SubInsRptNhq": "", "SubInsRptNarc": "", "FinalImpPermit": "", "RMImpQty": "", "SendToPPIC": "",
            "PPICLocalApp": "", "InsSampleCall": "", "SampleRec": "", "RPTDispatch": "", "PPICSent": "", "PPICApplyNarc": "", "RptForwrdRcv": "", "DivToDnc": "", "FinalPermit": "", "DeliverToIMD": "", "DtlRemarks": ""
        };
        //var itemData = { "ID": "", "GenericCode": "", "AnnualQuota": "", "ImportQtyPerYr": "", "ImportQtyCurYr": "", "ImportPurpose": "", "PermitApprovalDate": "", "ImportQty": "", "ImportDate": "", "SubDGDA": "", "ApproveDGDA": "", "SubNercotic": "" };



    });



    //$('#image-file').bind('change', function ()
    $('#UploadFile').on('change', function (e) {
        var checkInput = InputValidation('RefNo');
        if (checkInput == 0) {
            var files = e.target.files;
            var refId = $("#ID").val();
            if (refId != "") {
                var fileSize = 0;
                var fSizeStrg = "";
                $file = $("#UploadFile");
                for (var f = 0; f < files.length; f++) {
                    var iSize = ($file[0].files[f].size / 1024);
                    fileSize = (Math.round((iSize / 1024) * 100) / 100);
                    if (fSizeStrg != "") {
                        fSizeStrg += ',' + fileSize;
                    }
                    else {
                        fSizeStrg = fileSize;
                    }
                    if (iSize / 1024 > 25) {
                        iSize = (Math.round((iSize / 1024) * 100) / 100);
                        alert('File size is ' + iSize + ' MB');
                        $("#divLoading").show();
                        if (iSize > 25) {
                            toastr.warning(OperationMsg("UFW"));
                            $("#divLoading").hide();
                            return;
                        }
                    }
                }
                if (files.length > 0) {
                    if (window.FormData !== undefined) {
                        var data = new FormData();
                        for (var x = 0; x < files.length; x++) {
                            data.append("file" + x, files[x]);
                        }
                        $("#divLoading").show();
                        $.ajax({
                            type: "POST",
                            url: '@Url.Action("UploadFile", "NarcoticLicense")' + '?refLevel1=' + refId + '&refLevel2=' + "" + '&fileSize=' + fSizeStrg + '&refNo=' + $("#RefNo").val(),
                            contentType: false,
                            processData: false,
                            data: data,
                            success: function (result) {
                                $("#divLoading").hide();
                                if (result.msgType == "FUS") {
                                    toastr.success(OperationMsg(result.msgType));
                                    $("#FileGrid").data("kendoGrid").dataSource.data(result.FileList);
                                    $("#RefNo").val('--Select Any--');
                                }
                                else if (result.msgType == "FLI") {
                                    toastr.warning(OperationMsg(result.msgType));
                                }
                                else {
                                    toastr.warning(OperationMsg(result.msgType));
                                }
                            }

                        });
                    } else {
                        alert("This browser doesn't support HTML5 file uploads!");
                    }
                }
            }
            else {
                toastr.warning(OperationMsg("FI"));
            }
        }
        else {
            toastr.error(OperationMsg("SDN"));
        }

    });


</script>
